const form=document.getElementById('c-form')
let supportActive
let supportLevel
const createAlert=(target,type,message)=>{Array.from(target.getElementsByClassName('c-alert')).forEach(element=>element.remove())
const alert=document.createElement('div')
alert.classList.add('c-alert',`c-alert-${type}`)
alert.innerHTML=message
target.appendChild(alert)}
const checkLicense=(email,license)=>{if(license.length===35){const xhr=new XMLHttpRequest()
xhr.open('POST','https://sales.coreui.io/check.php',true)
xhr.setRequestHeader('Content-type','application/json')
xhr.onreadystatechange=()=>{if(xhr.readyState===4&&xhr.status===200){const json=JSON.parse(xhr.responseText)
const last=json.records.pop()
form.innerHTML=`Please use the following link to download your order - <a href="https://gumroad.com/purchases/${last.purchase_id}/receipt">Download</a>`}else{createAlert(form,'danger','The license number or email address is invalid.')}}
xhr.send(JSON.stringify({'email':email,'license':license}))}else{createAlert(form,'danger','The license number is invalid.')}}
form.onsubmit=event=>{event.preventDefault()
event.stopPropagation()
const target=event.currentTarget
const inputs=target.elements
if(target[0].checkValidity()===false){target.classList.add('c-was-validated')}else{const email=inputs['email'].value
const license=inputs['license'].value
checkLicense(email,license)}}